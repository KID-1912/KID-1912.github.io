---
layout:     post
title:      Pixi.js
subtitle:   快速的2D sprite渲染引擎
date:       2021-06-17
author:     page
header-img: img/post-bg-swift2.jpg
catalog: true
tags:
    - canvas
---

# Pixi.js

快速的2D sprite渲染引擎



## 安装

- node

```npm
npm i pixi.js
import * as PIXI from 'pixi.js'
```

- js

```html
<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
```



## 初体验

1. 测试

```js
(function () {
  let type = PIXI.utils.isWebGLSupported ? 'webGL' : 'canvas';
  PIXI.utils.sayHello(type);
})()
```

- PIXI 全局对象
  - PIXI.utils 工具库
  - PIXI.Application 应用类
  - PIXI.Loader 加载器类

2. 创建应用并编辑画布

```js
// 创建并编辑应用
let app = new PIXI.Application({
  width: 100,
  height: 100
});
document.body.appendChild(app.view); // app.view即canvas元素(画布)

// 更多的可覆盖的配置
let app2 = new PIXI.Application({
  width: 100,
  height: 100,
  antialias: true,  // 是否抗锯齿
  transparent: true, // 是否透明,默认为黑色
  resolution: 1 // 分辨率
  forceCanvas: true // 强制renderer使用canvasAPI
});
document.body.appendChild(app2.view);

// renderer渲染器 修改应用/重渲染画布
app.renderer.backgroundColor = 0xCC00FF; // 16进制颜色
app.renderer.autoResize = true; // 重设大小时自适应分辨率
app.render.resize(window.innerWidth, window.innerHeight);
```



## 精灵(sprites)

精灵是什么东西

#### 创建精灵

- 通过单个图像文件
- 通过雪碧图
- 通过纹理贴图

#### 纹理创建

**纹理:** Pixi使用WebGL在GPU上渲染图像，图像无法直接被GPU渲染，需要经过图像 -> 纹理 -> 显示图像的过程；

1. PIXI.Loader加载图像资源

   ```js
   const loader = new PIXI.Loader();
   loader.add("url/path")
   	.load(setup);
   ```

2. 图像的纹理，创建精灵并添加至舞台

   ```js
   function setup(){
       var texture = loader.resources["url/path"].texture;
       var sprites = new PIXI.Sprites(texture);
       app.stage.addChild(sprite);
   }
   ```

**附：**

- loader.resources["url/path"].texture获取图像资源的纹理对象外，通过PIXI.utils.TextureCache("url/path")工具方法允许从纹理缓存中取出对应资源的纹理对象；
- stage是一个pixi容器，不同于app.view(画布元素)，stage用于容纳pixi其它对象的对象，对stage的操作也会反应在view上；
- 如果想移除精灵，即app.stage.removeChild(sprite)；或者隐藏精灵：sprite.visible = false；

**纹理的其它方式**

- js对象

  ```js
  // 1. 创建Image实例
  var img = new Image();
  img.setAttribute("src", "/images/awards.png");
  // 2. 转纹理
  var baseTexture = new PIXI.BaseTexture(img);	// 纹理物料实例
  var texture = new PIXI.Texture(baseTexture);	// 纹理实例
  var sprite = new PIXI.Sprite(texture);
  app.stage.addChild(sprite);
  ```

