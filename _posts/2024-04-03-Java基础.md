---
layout:     post
title:      Java
subtitle:   
date:       2024-03-16
author:     page
header-img: img/Nuxt.png
catalog: true
tags:
    - 
---

# Java

## 简介

**广泛应用的 Java**

- Java是基于JVM虚拟机的跨平台语言，一次编写，到处运行；

- Java程序易于编写，而且有内置垃圾收集，不必考虑内存管理；

- Java虚拟机拥有工业级的稳定性和高度优化的性能，且经过了长时期的考验；

- Java拥有最广泛的开源社区支持，各种高质量组件随时可用。

**作者**：SUN公司（已被Oracle收购）的 [詹姆斯·高斯林](https://en.wikipedia.org/wiki/James_Gosling)

**一次编写，到处运行**

Java介于编译型语言和解释型语言之间，将代码编译成一种“字节码”，它类似于抽象的CPU指令；然后，针对不同平台编写虚拟机，不同平台的虚拟机(JVM)负责加载字节码并执行；对Java开发者而言，实现了一次编写，到处运行

**Java版本**

- Java ME：针对嵌入式设备的“瘦身版”

- Java SE：标准版，包含标准的JVM和标准库

- Java EE：企业版，Java SE基础上加上了大量的API和库，以便方便开发Web应用、数据库、消息服务

**JRE**：运行Java字节码的虚拟机（Java Runtime Environment）

**jdk**：要编译成Java字节码还需JDK（Java Development Kit），JDK包含JRE，还提供了编译器、调试器等开发工具

```ascii
 ┌─    ┌──────────────────────────────────┐
  │     │     Compiler, debugger, etc.     │
  │     └──────────────────────────────────┘
 JDK ┌─ ┌──────────────────────────────────┐
  │  │  │                                  │
  │ JRE │      JVM + Runtime Library       │
  │  │  │                                  │
  └─ └─ └──────────────────────────────────┘
        ┌───────┐┌───────┐┌───────┐┌───────┐
        │Windows││ Linux ││ macOS ││others │
        └───────┘└───────┘└───────┘└───────┘
```

**JSR规范**：Java平台功能规范，从JVM的内存模型到Web程序接口（Java Specification Request），它由JCP组织审核

## 安装

### JDK

[Oracle的官网](https://www.oracle.com/java/technologies/downloads/)下载对应稳定版JDK：[Java Downloads | Oracle](https://www.oracle.com/java/technologies/downloads/)

**设置环境变量**

java 1.5后无需手动设置环境，如需要可在系统环境变量新增

`Path=%JAVA_HOME%\bin;<现有的其他路径>`

**运行**：`java -version` 尝试查看版本

### 程序代码

```java
// Hello.java
public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello, world!");
    }
}
```

Java规定，某个类定义的 `public static void main(String[] args)` 是Java程序的固定入口方法，必须定义为 `public` 类型的静态class，Java程序总是从`main`方法开始执行

文件名必须与类名完全保持一致

**运行代码**

通过 javac 将 `.java` 文件编译成 `.class` 字节码文件：`javac Hello.java`

虚拟机执行字节码文件，将自动寻找参数对应 `.class` 文件：`java Hello`

或者直接 `java Hello.java`

## Java基础

### 程序基本结构

Java是面向对象的语言，一个程序的基本单位就是 `class`，`class` 是关键字，这里定义的 `class` 名字就是 `Hello`

```java
public class Hello { // 类名是Hello
    // ...
} // class定义结束
```

若无 `public`，也能正确编译，但是这个类将无法从命令行执行

`class`内部，可以定义若干方法（method）：

```java
public class Hello {
    public static void main(String[] args) { // 方法名是main
        // 方法代码...
    } // 方法定义结束
}
```

### 变量与数据类型

声明变量：`int a = 100; int b`

变量赋值：`a = 200; int c = a; `

**基本数据类型**

- 整数类型：byte，short，int，long

- 浮点数类型：float，double

- 字符类型：char

- 布尔类型：boolean

**整型**

```java
int i2 = -2147483648;
int i3 = 2_000_000_000; // 加下划线更容易识别
int i4 = 0xff0000; // 十六进制
long n1 = 9000000000000000000L; // long型的结尾需要加L
long n2 = 900; // 此处900为int，但int类型可以赋值给long
int i6 = 900L; // 错误：不能把long型赋值给int
```

**浮点型**

```java
float f1 = 3.14f;
float f2 = 3.14e38f; // 科学计数法表示的3.14x10^3
double d = 1.79e308;
double d2 = -1.79e308;
double d3 = 4.9e-324; // 科学计数法表示的4.9x10^-3248
```

**布尔类型**

```java
boolean b1 = true;
boolean b2 = false;
boolean isGreater = 5 > 3; // 计算结果为true
```

**字符串类型**

**字符类型**

```java
char a = 'A'; // 单引号 '
```

**引用类型**

```java
String s = "hello";
```

**常量**

```java
final double PI = 3.14; // final 修饰符
```

**var 关键字**

赋值语句自动推断出变量的类型：

```java
var sb = new StringBuilder();
StringBuilder sb = new StringBuilder();
```

**作用域**

java存在块级作用域，以 `{}` 为分隔

### 基础运算

**整数运算**

整数运算永远返回整数

```java
int x = 12345 / 67; // 184
int y = 12345 % 67; // 12345÷67的余数是17
```

参与运算的两个数类型不一致，那么计算结果为较大类型的整型。例如，`short` 和`int` 计算，结果总是 `int`

也支持强制转型：

`short s = (short) i; // 12345`

`int n3 = (int) (12.7 + 0.5); // 13`

**字符串运算**

\ 转义

```java
String s = "abc\"xyz"; // 包含7个字符: a, b, c, ", x, y, z、
// \n 换行
```

多行字符串

```java
String s = """
           SELECT * FROM
             users
           WHERE id > 100
           ORDER BY name DESC""";
```

### 数组类型

一组相同类型的变量

```java
int[] ns = new int[3]; // 一组字符串的数组
ns[0] = 68;
ns[1] = 79;
ns[2] = 91;
System.out.println(ns[3]); // 索引n不能超出范围
```

直接初始化

```java
ns = new int[] { 68, 79, 91, 85, 62 };
// 简化为
int[] ns = { 68, 79, 91, 85, 62 };
String[] names = {
    "ABC", "XYZ", "zoo"
};
```

## 流程控制

### 输入输出

**输出方法**

`System.out.print()`

`System.out.println()` 输出并换行

`System.out.printf(f, String)` 格式化输出

**格式化输出**

指定输出内容格式，并传入参数得到格式输出结果

```java
public class Hello {
    public static void main(String[] args) {
        double num = 3.1415926;
        System.out.printf("%.2f\n", num); // 3.14
    }
}
```

| 占位符 | 说明               |
| --- | ---------------- |
| %d  | 格式化输出整数          |
| %x  | 格式化输出十六进制整数      |
| %f  | 格式化输出浮点数         |
| %e  | 格式化输出科学计数法表示的浮点数 |
| %s  | 格式化字符串           |

### 条件语句

**判断变量值相等**

```java
int n = 90;
if(n == 90) {
  ...
}
```

**判断引用相等**

```java
String s1 = "hello";
String s2 = "HELLO".toLowerCase();
if (s1 == s2) {
    System.out.println("s1 == s2");
} else {
    System.out.println("s1 != s2");
}
```

**判断引用类型值相等**

```java
s1.equals(s2); // s1 为 null则会报错 NullPointerException
```

### 多重选择

**switch**

除了基础 switch 语法，还有表达式语法

```java
public static void main(String[] args) {
    int n = 90;
    String result = switch(n){
        case 10 -> "is 10"; // 直接返回
        case 90 -> "is 90";
        default -> {
            yield "is 999"; // yield关键字
        }
    };
    System.out.println(result);
}
```

### 循环

while/do while/ for

## 数组操作

### 遍历数组

```java
int[] list = { 6, 6, 6, 1, 8 };
for (int i = 0;i < list.length;i++) {
    System.out.println(list[i]);
}
```

`for each` 循环，迭代数组的每个元素

```java
int[] list = { 6, 6, 6, 1, 8 };  
for (int num : list) {
    System.out.println(num);
}
```

快速打印数组内容为字符串

```java
import java.util.Arrays; // Java标准库提供
...
int[] ns = { 1, 1, 2, 3, 5, 8 };
System.out.println(Arrays.toString(ns));
```

### 数组排序

**冒泡排序**

**内置sort**

只需调用JDK提供的 `Arrays.sort()`，注意这将修改数组

### 多维数组

```js
int[][] ns = {
   { 1, 2, 3, 4 },
   { 5, 6, 7, 8 },
   { 9, 10, 11, 12 }
};

Arrays.deepToString(ns);
```

### 命令行参数

Java程序的入口是 `main` 方法，接受一个命令行参数，一个 `String[]` 数组；

```java
import java.util.Arrays;

public class Main {
public static void main(String[] args) {
    System.out.println(Arrays.toString(args));
}
}
```

## 面向对象

### 面向对象基础
