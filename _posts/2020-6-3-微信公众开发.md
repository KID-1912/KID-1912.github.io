---
layout:     post
title:      微信公众平台
subtitle:   微信内部生态开发，包括服务号、订阅号、小程序、企业微信
date:       2021-6-03
author:     page
header-img: img/post-bg-re-vs-ng2.jpg
catalog: true
tags:
    - 微信开发
---

# 微信公众平台开发

## 基本概念

- 登录与授权
  - 登录即允许主动调用wx.login获取openId和session_key
  - 授权即被动open-type获取用户信息加密版给后台解密后返回

## 微信生态ID

ID用于标识用户与开发者，借此来实现微信服务

- OpenID -> 用户在一个小程序中的唯一标识（wx.login + code2Session）
- UnionID -> 用户在一个开放平台所有应用下的唯一id
  - 获取方式
      1. 小程序wx.getUserInfo -> 后台解密出UnionID（需授权）
      2. 用户关注了同主体公众号下，wx.login + code2Session 获取到 UnionID（无需再次授权）
      3. 用户关注/授权登录了同主体公众号/应用下，小程序云函数cloud.getWXContext获取
      4. 小程序支付完成后getPaidUnionId，仅支付后5分钟（无需授权）
- AppID 小程序身份证，借此获取微信接口使用权限
- AppSecret : 小程序唯一凭证密钥

## 公众号开发

- 授权
- weixin-js-sdk share 分享授权总结
  1. 发送请求获取appId和jsApiTicket
  2. wx.config配置参数包括appId,timestamp当前时间戳,signature使用SHA1加密jsApiTicket，页面url等，jsApiList注册api列表
  3. wx.ready已完成，可使用wx.api系列方法
